<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canvas Rendering Engine</title>
</head>
<style>
  canvas {
    display: block;
    margin: 40px auto;
    border: 1px solid black;
  }
</style>
<body>
  <canvas></canvas>

  <script src="dist/canvas-engine.js" type="text/javascript"></script>
  <script>
    (function() {
      // API and Testing
      const engine = Engine()

      let emitter = Engine.createEmitter(5, {
        size: { width: 8, height: 2 },
        source: { x: engine.sizes.width / 2, y: engine.sizes.height / 2 },
        renderParticle: function(ctx) {
          let { x, y } = this.position
          ctx.fillStyle = Engine.random.inArray([ 'red', 'blue', 'green' ])
          ctx.fillRect(x, y, this.size.width, this.size.height)
        }
      })

      engine.start({
        loop: function() {
          // emitter.emit()
          emitter.particles.forEach(p => p.move())
        },
        render: function(ctx) {
          emitter.render(ctx)
        }
      })

      function getCursorPosition(canvas, event) {
        let rect = canvas.getBoundingClientRect();
        let x = event.clientX - rect.left;
        let y = event.clientY - rect.top;

        return { x, y }
      }

      engine.canvas.onmousemove = function(event) {
        let pos = getCursorPosition(engine.canvas, event)
        emitter.setSource(pos)
      }

      engine.canvas.onclick = function() {
        emitter.emit()
        // engine.togglePause()
      }
    })()
  </script>
</body>
</html>
